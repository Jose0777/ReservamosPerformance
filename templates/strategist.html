{% import "bootstrap/wtf.html" as wtf %}
{% extends "base.html" %}
{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
  $(document).ready(function(){
    $(".evaluation_by_Q").hide()
    $("#name-select").on('change', function(){
        var user_email = '{{ email }}' //email of the evaluator
        alert(user_email)
        var data = JSON.parse('{{ people | tojson | safe}}');
        name_value=($(this).val()); // name of evaluated person
        alert(name_value+' evaluated person')
        for (i = 1; i < Object.keys(data).length+1; i++) {
          if (data[i]['name']===name_value) {
            leader_person = data[i]['leader']
            alert(leader_person+' leader of evaluated person')
          }
          if (data[i]['email']===user_email) {
            name_evaluator = data[i]['name']
            alert(name_evaluator+' evaluator')
          }
        }
        if (name_evaluator===leader_person) {
          $(".evaluation_by_Q").show()
        }
    });
  });
</script>
<div class="container">
  <h1 class="title">Welcome, {{name}}! </h1>

  <div class="col-lg-8 col-md-10 mx-auto ">

  <form action="{{url_for('submit')}}" method="POST">

    <fieldset>
      <legend>Evaluated Person:</legend>
        <select name="name_person" id="name-select" onchange="getSelectedName();" required>
          <option value="">--Please choose an option--</option>
          {% for index in people: %}
          <option value="{{ people[index]['name'] }}">{{ people[index]['name'] }}</option>
          {% endfor %}
        </select>

      <br>
      {% for question in questions %}
      {% if (question['id']==1) or (question['id']-1)%3 == 0: %}
      <br>
      <legend> {{question['category']}} </legend>
      <br>
      {% endif %}
      <legend>{{question['id']}}.- {{ question['question'] }}</legend>
      <div class="question">
        <input type="radio" id="option1" name="a{{question['id']}}" value="0" required>Totalmente en Desacuerdo
        <input type="radio" id="option2" name="a{{question['id']}}" value="1" required>En desacuerdo
        <input type="radio" id="option3" name="a{{question['id']}}" value="2" required>Neutro
        <input type="radio" id="option4" name="a{{question['id']}}" value="3" required>De acuerdo
        <input type="radio" id="option5" name="a{{question['id']}}" value="4" required>Totalmente de acuerdo
        <br>
      </div>
      {% endfor %}
      <br>

      <div class="evaluation_by_Q">
        <h1>Evaluación por Q's</h1>
        <p> Si eres líder de equipo ingresa la evaluación por Q's de la persona evaluada</p>
          <label for="Q1">Q1:</label>
          <input type="number" step="any" id="Q1" name="Q1" placeholder="--">%<br>
          <label for="Q2">Q2:</label>
          <input type="number" step="any" id="Q2" name="Q2" placeholder="--">%<br>
          <label for="Q3">Q3:</label>
          <input type="number" step="any" id="Q3" name="Q3" placeholder="--">%<br>
          <label for="Q4">Q4:</label>
          <input type="number" step="any" id="Q4" name="Q4" placeholder="--">%<br>
      </div>

      <button type="submit" class="btn btn-primary" id="send">Send</button>
    </fieldset>
  </form>
    <br>
    </div>

</div>
{% endblock %}